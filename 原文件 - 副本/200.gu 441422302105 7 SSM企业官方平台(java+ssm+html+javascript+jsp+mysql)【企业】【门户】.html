<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/avatar.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/avatar.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":false,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":0,"unescape":false,"preload":false},"motion":{"enable":false,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.json"};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="Java源码社">
<meta property="og:site_name" content="Java源码社">
<meta property="og:locale" content="zh_CN">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://example.com/%E5%8E%9F%E6%96%87%E4%BB%B6%20-%20%E5%89%AF%E6%9C%AC/200.gu%20441422302105%207%20SSM%E4%BC%81%E4%B8%9A%E5%AE%98%E6%96%B9%E5%B9%B3%E5%8F%B0(java+ssm+html+javascript+jsp+mysql)%E3%80%90%E4%BC%81%E4%B8%9A%E3%80%91%E3%80%90%E9%97%A8%E6%88%B7%E3%80%91">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>
<link rel="stylesheet" type="text/css" href="/css/injector/main.css" /><link rel="preload" as="style" href="/css/injector/light.css" /><link rel="preload" as="style" href="/css/injector/dark.css" />
  <title> | Java源码社
</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Java源码社</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>联系站长</a>

  </li>
        <li class="menu-item menu-item-remote">

    <a href="/remote/" rel="section"><i class="fa fa-link fa-fw"></i>远程说明</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索...书店、票、购物、图书、学生…" spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
  
  

          <div class="content page posts-expand">
            

    
    
    
    <div class="post-block" lang="zh-CN">
      <header class="post-header">

<h1 class="post-title" itemprop="name headline">
</h1>

<div class="post-meta">
  

</div>

</header>

      
      
      

      <div class="post-body">
          <p><img src="../images/project21/560023322402.jpg" alt="560023322402"></p>
<p><img src="../images/project21/570023322402.jpg" alt="570023322402"></p>
<p><img src="../images/project21/580023322402.jpg" alt="580023322402"></p>
<p><img src="../images/project21/000023332402.jpg" alt="000023332402"></p>
<p><img src="../images/project21/010023332402.jpg" alt="010023332402"></p>
<p><img src="../images/project21/020023332402.jpg" alt="020023332402"></p>
<p>——————————ProjectTitle——————————</p>
<p>项目介绍</p>
<p>管理员角色包含以下功能： 登录,首页,写公司资讯,评论审核,公司资讯信息管理,公司资讯类别信息管理,添加导航,导航信息管理,评论信息管理,修改个人信息,友情链接管理,修改密码,退出系统等功能。 用户角色包含以下功能： 首页,招聘信息,产品介绍,联系我们,关于我们,后台地址,公司荣誉,最新公司资讯,技术支持等功能。</p>
<p>环境需要</p>
<p>1.运行环境：最好是java jdk 1.8，我们在这个平台上运行的。其他版本理论上也可以。 2.IDE环境：IDEA，Eclipse,Myeclipse都可以。推荐IDEA; 3.tomcat环境：Tomcat 7.x,8.x,9.x版本均可 4.硬件环境：windows 7/8/10 1G内存以上；或者 Mac OS；  5.数据库：MySql 5.7版本；</p>
<p>技术栈</p>
<ol>
<li>后端：Spring+SpringMVC+Mybatis 2. 前端：HTML+CSS+JavaScript+jsp</li>
</ol>
<p>使用说明</p>
<ol>
<li>使用Navicat或者其它工具，在mysql中创建对应名称的数据库，并导入项目的sql文件； 2. 使用IDEA/Eclipse/MyEclipse导入项目，Eclipse/MyEclipse导入时，若为maven项目请选择maven;若为maven项目，导入成功后请执行maven clean;maven install命令，然后运行； 3. 将项目中application.yml配置文件中的数据库配置改为自己的配置; 4. 运行项目，输入localhost:8080/ 登录</li>
</ol>
<p>——————————OldCode——————————</p>
<p>用户管理控制层：</p>
<p>@Controller</p>
<p>@RequestMapping(“/user”)</p>
<p>public class UserController extends BaseController{</p>
<p>private String prefix = “system/user/“;</p>
<p>@Autowired</p>
<p>IUserService iUserService;</p>
<p>@Autowired</p>
<p>IRoleService iRoleService;</p>
<p>@Autowired</p>
<p>IDeptService iDeptService;</p>
<p>@Autowired</p>
<p>IPositionService iPositionService;</p>
<p>@Autowired</p>
<p>private SysPasswordService passwordService;</p>
<p>/**</p>
<ul>
<li><p>@描述 跳转到用户页面</p>
</li>
<li><p>@date 2018/9/16 10:54</p>
</li>
</ul>
<p>*/</p>
<p>@RequestMapping(“/tolist”)</p>
<p>@RequiresPermissions(“user:list”)</p>
<p>public String toUserList()</p>
<p>return prefix + “user”;</p>
<p>/**</p>
<ul>
<li><p>@描述 用户数据</p>
</li>
<li><p>@date 2018/9/15 12:30</p>
</li>
</ul>
<p>*/</p>
<p>@RequestMapping(“/tableList”)</p>
<p>@ResponseBody</p>
<p>public TableDataInfo list(User user)</p>
<p>startPage();</p>
<p>List<User> users = iUserService.selectByUser(user);</User></p>
<p>return getDataTable(users);</p>
<p>/**</p>
<ul>
<li>编辑用户 system/user/edit/20180914-1</li>
</ul>
<p>*/</p>
<p>@RequiresPermissions(“user:update”)</p>
<p>@RequestMapping(“/edit/{userId}”)</p>
<p>public String edit(@PathVariable(“userId”) String userId, Model model)</p>
<p>// 个人信息</p>
<p>User user = iUserService.selectByPrimaryKey(userId);</p>
<p>Map&lt;String, Object&gt; role_post_dept = getRole_Post_Dept();</p>
<p>model.addAttribute(“depts”, role_post_dept.get(“dept”));</p>
<p>model.addAttribute(“roles”, role_post_dept.get(“role”));</p>
<p>model.addAttribute(“positions”, role_post_dept.get(“position”));</p>
<p>model.addAttribute(“user”, user);</p>
<p>return prefix + “edit”;</p>
<p>/**</p>
<ul>
<li><p>@描述 保存用户</p>
</li>
<li><p>@date 2018/9/15 18:53</p>
</li>
</ul>
<p>*/</p>
<p>@PostMapping(“/editSave”)</p>
<p>@RequiresPermissions(“user:update”)</p>
<p>@Operlog(modal = “用户管理”, descr = “修改用户信息”)</p>
<p>@ResponseBody</p>
<p>public AjaxResult save(User user)</p>
<p>if (StringUtils.isNotNull(user.getUid()) &amp;&amp; User.isBoss(user.getUid()))</p>
<p>return error(“不允许修改管理员用户”);</p>
<p>if(user.getPwd()!=null){</p>
<p>user.setSalt(ShiroUtils.randomSalt());</p>
<p>SimpleHash md5 = new SimpleHash(“MD5”, user.getPwd(), user.getSalt(), 1024);</p>
<p>user.setPwd(md5.toHex());</p>
<p>return result(iUserService.updateByPrimaryKeySelective(user));</p>
<p>/**</p>
<ul>
<li><p>@描述 添加用户页面</p>
</li>
<li><p>@date 2018/9/15 18:46</p>
</li>
</ul>
<p>*/</p>
<p>@RequestMapping(“/toAdd”)</p>
<p>@RequiresPermissions(“user:add”)</p>
<p>public String toaddUser(Model model)</p>
<p>Map&lt;String, Object&gt; role_post_dept = getRole_Post_Dept();</p>
<p>model.addAttribute(“depts”, role_post_dept.get(“dept”));</p>
<p>model.addAttribute(“roles”, role_post_dept.get(“role”));</p>
<p>model.addAttribute(“positions”, role_post_dept.get(“position”));</p>
<p>return prefix + “add”;</p>
<p>/**</p>
<ul>
<li><p>@描述 添加用户</p>
</li>
<li><p>@date 2018/9/15 20:40</p>
</li>
</ul>
<p>*/</p>
<p>@RequestMapping(“/addSave”)</p>
<p>@RequiresPermissions(“user:add”)</p>
<p>@Operlog(modal = “用户管理”, descr = “添加用户”)</p>
<p>@ResponseBody</p>
<p>public AjaxResult addUser(User user)</p>
<p>user.setSalt(ShiroUtils.randomSalt());</p>
<p>SimpleHash md5 = new SimpleHash(“MD5”, user.getPwd(), user.getSalt(), 1024);</p>
<p>user.setPwd(md5.toHex());</p>
<p>user.setAvatar(CsEnum.avatar.USER_AVATAR.getValue());</p>
<p>user.setCreateTime(new Date());</p>
<p>return result(iUserService.insertSelective(user));</p>
<p>/**</p>
<ul>
<li><p>@描述 批量删除</p>
</li>
<li><p>@date 2018/9/16 9:31</p>
</li>
</ul>
<p>*/</p>
<p>@RequestMapping(“/del”)</p>
<p>@RequiresPermissions(“user:del”)</p>
<p>@Operlog(modal = “用户模块”, descr = “删除用户”)</p>
<p>@ResponseBody</p>
<p>public AjaxResult delByUserIds(String[] ids)</p>
<p>try</p>
<p>int i = iUserService.deleteByPrimaryKeys(ids);</p>
<p>catch (Exception e)</p>
<p>return error(e.getMessage());</p>
<p>return success();</p>
<p>/**</p>
<ul>
<li><p>@描述 编辑密码修改页面</p>
</li>
<li><p>@date 2018/9/16 10:25</p>
</li>
</ul>
<p>*/</p>
<p>@RequestMapping(“/resetPwd/{userId}”)</p>
<p>@RequiresPermissions(“user:update”)</p>
<p>public String editPwd(@PathVariable(“userId”) String id, Model model)</p>
<p>model.addAttribute(“uid”, id);</p>
<p>return prefix + “resetPwd”;</p>
<p>/**</p>
<ul>
<li><p>@描述 密码修改</p>
</li>
<li><p>@date 2018/9/16 10:42</p>
</li>
</ul>
<p>*/</p>
<p>@RequestMapping(“/resetPwd”)</p>
<p>@RequiresPermissions(“user:update”)</p>
<p>@Operlog(modal = “用户模块”, descr = “修改密码”)</p>
<p>@ResponseBody</p>
<p>public AjaxResult resetPwd(User user)</p>
<p>return result(iUserService.resrtPwd(user));</p>
<p>/**</p>
<ul>
<li>校验手机号码</li>
</ul>
<p>*/</p>
<p>@PostMapping(“/checkPhoneUnique”)</p>
<p>@ResponseBody</p>
<p>public String checkPhoneUnique(User user)</p>
<p>String uniqueFlag = “0”;</p>
<p>if (user != null)</p>
<p>uniqueFlag = iUserService.checkPhoneUnique(user);</p>
<p>return uniqueFlag;</p>
<p>/**</p>
<ul>
<li>校验email邮箱</li>
</ul>
<p>*/</p>
<p>@PostMapping(“/checkEmailUnique”)</p>
<p>@ResponseBody</p>
<p>public String checkEmailUnique(User user)</p>
<p>String uniqueFlag = “0”;</p>
<p>if (user != null)</p>
<p>uniqueFlag = iUserService.checkEmailUnique(user);</p>
<p>return uniqueFlag;</p>
<p>/**</p>
<ul>
<li><p>@描述: 校验登录名唯一性</p>
</li>
<li><p>@params:</p>
</li>
<li><p>@return:</p>
</li>
<li><p>@date: 2018/10/2 17:06</p>
</li>
</ul>
<p>*/</p>
<p>@PostMapping(“/checkLoginNameUnique”)</p>
<p>@ResponseBody</p>
<p>public String checkLoginNameUnique(User user)</p>
<p>String uniqueFlag = “0”;</p>
<p>if (user != null)</p>
<p>uniqueFlag = iUserService.checkLoginNameUnique(user);</p>
<p>return uniqueFlag;</p>
<p>public Map&lt;String, Object&gt; getRole_Post_Dept()</p>
<p>Map&lt;String, Object&gt; map = new HashMap&lt;&gt;();</p>
<p>//        角色</p>
<p>List<Role> roles = iRoleService.selectRoleList(new Role());</Role></p>
<p>//        部门信息</p>
<p>List<Dept> depts = iDeptService.selectDeptList(new Dept());</Dept></p>
<p>//        岗位</p>
<p>List<Position> positions = iPositionService.selectPositionList(new Position());</Position></p>
<p>map.put(“role”, roles);</p>
<p>map.put(“dept”, depts);</p>
<p>map.put(“position”, positions);</p>
<p>return map;</p>
<p>/**</p>
<ul>
<li>用户个人信息查看页面</li>
</ul>
<p>*/</p>
<p>@RequestMapping(“/myMsg”)</p>
<p>public String ToMyMsg(Model model, HttpServletRequest request)</p>
<p>User user = iUserService.selectByPrimaryKey(getUserId());</p>
<p>model.addAttribute(“user”, user);</p>
<p>model.addAttribute(“loginIp”, HttpHeaderUtil.getIpAddr(request));</p>
<p>return prefix + “profile/msg”;</p>
<p>/**</p>
<ul>
<li>密码修改页面</li>
</ul>
<p>*/</p>
<p>@RequestMapping(“/resetMyPwd”)</p>
<p>public String toResetPwd(Model model)</p>
<p>User user = iUserService.selectByPrimaryKey(getUserId());</p>
<p>model.addAttribute(“user”, user);</p>
<p>return prefix + “profile/resetPwd”;</p>
<p>/**</p>
<ul>
<li>密码修改保存</li>
</ul>
<p>*/</p>
<p>@RequestMapping(“/updateMyPwdSave”)</p>
<p>@ResponseBody</p>
<p>@RequiresPermissions(“user:update”)</p>
<p>@Operlog(modal = “个人信息”, descr = “修改密码”)</p>
<p>public AjaxResult updateMyPwdSave(String password)</p>
<p>User user = new User();</p>
<p>user.setSalt(ShiroUtils.randomSalt());</p>
<p>SimpleHash md5 = new SimpleHash(“MD5”, password, user.getSalt(), 1024);</p>
<p>user.setPwd(md5.toHex());</p>
<p>user.setUid(getUserId());</p>
<p>int i = iUserService.updateByPrimaryKeySelective(user);</p>
<p>if (i &gt; 0)</p>
<p>//更新shiro中的信息</p>
<p>ShiroUtils.reloadUser(iUserService.selectByPrimaryKey(getUserId()));</p>
<p>return success();</p>
<p>return error();</p>
<p>/**</p>
<ul>
<li>编辑用户头像修改</li>
</ul>
<p>*/</p>
<p>@RequestMapping(“/updateAvatar”)</p>
<p>public String toupdateAvatar(Model model)</p>
<p>model.addAttribute(“user”, getUser());</p>
<p>return prefix + “profile/avatar”;</p>
<p>/**</p>
<ul>
<li>修改保存用户头像</li>
</ul>
<p>*/</p>
<p>@RequestMapping(“/updateAvatarSave”)</p>
<p>@RequiresPermissions(“user:update”)</p>
<p>@Operlog(modal = “个人信息”, descr = “修改头像”)</p>
<p>@ResponseBody</p>
<p>public AjaxResult toupdateAvatar(MultipartFile file)</p>
<p>try</p>
<p>String imgPath = UploadFile.uploadUserImg(file);</p>
<p>if (StringUtils.isEmpty(imgPath))</p>
<p>return error(“图片上传失败，稍后再试！”);</p>
<p>User user = new User();</p>
<p>user.setUid(getUserId());</p>
<p>user.setAvatar(imgPath);</p>
<p>int i = iUserService.updateByPrimaryKeySelective(user);</p>
<p>if (i &gt; 0)</p>
<p>ShiroUtils.reloadUser(iUserService.selectByPrimaryKey(getUserId()));</p>
<p>return result(i);</p>
<p>catch (IOException e)</p>
<p>return error();</p>
<p>catch (FileSizeException e)</p>
<p>//文件过大</p>
<p>return error(e.getMsg());</p>
<p>catch (FileNameLengthException e)</p>
<p>//文件名字超长</p>
<p>return error(e.getMsg());</p>
<p>/**</p>
<ul>
<li>校验密码和原来密码是否相同</li>
</ul>
<p>*/</p>
<p>@RequestMapping(“/checkPassword”)</p>
<p>@ResponseBody</p>
<p>public boolean checkPassword(String password)</p>
<p>//加密后与数据库密码比较</p>
<p>User user = getUser();</p>
<p>SimpleHash md5 = new SimpleHash(“MD5”, password, user.getSalt(), 1024);</p>
<p>String oldPassword = md5.toHex();</p>
<p>String pwd = getPwd();</p>
<p>if (pwd.equals(oldPassword))</p>
<p>return true;</p>
<p>return false;</p>
<p>角色管理控制层：</p>
<p>@Controller</p>
<p>@RequestMapping(“/role”)</p>
<p>public class RoleController extends BaseController{</p>
<p>private String prefix = “system/role/“;</p>
<p>@Autowired</p>
<p>IUserService iUserService;</p>
<p>@Autowired</p>
<p>IRoleService iRoleService;</p>
<p>@Autowired</p>
<p>IPermissionService iPermissionService;</p>
<p>/**</p>
<ul>
<li><p>@描述 页面跳转</p>
</li>
<li><p>@date 2018/9/16 10:59</p>
</li>
</ul>
<p>*/</p>
<p>@RequestMapping(“/tolist”)</p>
<p>@RequiresPermissions(“role:list”)</p>
<p>public String tolist()</p>
<p>return prefix + “role”;</p>
<p>/**</p>
<ul>
<li><p>@描述 ajax请求所有</p>
</li>
<li><p>@date 2018/9/16 10:48</p>
</li>
</ul>
<p>*/</p>
<p>@RequestMapping(“/ajaxlist”)</p>
<p>@ResponseBody</p>
<p>public List<Role> list(Role role)</Role></p>
<p>List<Role> roles = iRoleService.selectRoleList(role);</Role></p>
<p>return roles;</p>
<p>/**</p>
<ul>
<li><p>@描述 列表</p>
</li>
<li><p>@date 2018/9/16 10:52</p>
</li>
</ul>
<p>*/</p>
<p>@RequestMapping(“/tableList”)</p>
<p>@ResponseBody</p>
<p>public TableDataInfo listPag(Role role)</p>
<p>//开启分页</p>
<p>startPage();</p>
<p>List<Role> roles = iRoleService.selectRoleList(role);</Role></p>
<p>return getDataTable(roles);</p>
<p>/**</p>
<ul>
<li><p>@描述 新增页面</p>
</li>
<li><p>@date 2018/9/16 11:37</p>
</li>
</ul>
<p>*/</p>
<p>@RequestMapping(“/toAdd”)</p>
<p>@RequiresPermissions(“role:add”)</p>
<p>public String toAdd(Model model)</p>
<p>return prefix + “add”;</p>
<p>/**</p>
<ul>
<li><p>@描述 批量删除</p>
</li>
<li><p>@date 2018/9/16 11:53</p>
</li>
</ul>
<p>*/</p>
<p>@RequestMapping(“/del”)</p>
<p>@RequiresPermissions(“role:del”)</p>
<p>@Operlog(modal = “角色管理”,descr = “删除角色”)</p>
<p>@ResponseBody</p>
<p>public AjaxResult del(Integer[] ids)</p>
<p>try</p>
<p>iRoleService.deleteByPrimaryKeys(ids);</p>
<p>catch (Exception e)</p>
<p>return error(e.getMessage());</p>
<p>return success();</p>
<p>/**</p>
<ul>
<li><p>@描述 添加保存</p>
</li>
<li><p>@date 2018/9/16 11:54</p>
</li>
</ul>
<p>*/</p>
<p>@RequestMapping(“/addSave”)</p>
<p>@RequiresPermissions(“role:update”)</p>
<p>@Operlog(modal = “角色管理”,descr = “添加角色”)</p>
<p>@ResponseBody</p>
<p>public AjaxResult addRole(Role role, Integer[] ids)</p>
<p>role.setCreateTime(new Date());</p>
<p>int insert = 0;</p>
<p>try</p>
<p>if (StringUtils.isEmpty(ids))</p>
<p>ids = new Integer[0];</p>
<p>insert = iRoleService.insert(role, ids);</p>
<p>catch (Exception e)</p>
<p>return error(e.getMessage());</p>
<p>//清空缓存</p>
<p>ShiroUtils.clearCachedAuthorizationInfo();</p>
<p>return  result(insert);</p>
<p>/**</p>
<ul>
<li><p>@描述: 根据ID 获取u他的所有权限 做回显</p>
</li>
<li><p>@params: roleId 角色Id</p>
</li>
<li><p>@return:</p>
</li>
<li><p>@date: 2018/9/27 14:04</p>
</li>
</ul>
<p>*/</p>
<p>@RequestMapping(“/selectById/{roleId}”)</p>
<p>@ResponseBody</p>
<p>public Role selectById(@PathVariable(“roleId”) Integer roleId)</p>
<p>Role role = iRoleService.selectByPrimaryKey(roleId);</p>
<p>return role;</p>
<p>/**</p>
<ul>
<li><p>@描述 编辑修改页面</p>
</li>
<li><p>@date 2018/9/16 14:06</p>
</li>
</ul>
<p>*/</p>
<p>@RequestMapping(“/edit/{id}”)</p>
<p>@RequiresPermissions(“role:update”)</p>
<p>public String edit(@PathVariable(“id”) Integer id, Model model)</p>
<p>Role role = iRoleService.selectByPrimaryKey(id);</p>
<p>model.addAttribute(“Role”, role);</p>
<p>return prefix + “edit”;</p>
<p>/**</p>
<ul>
<li><p>@描述 编辑修改权限页面</p>
</li>
<li><p>@date 2018/9/16 14:06</p>
</li>
</ul>
<p>*/</p>
<p>@RequestMapping(“/editPower/{id}”)</p>
<p>@RequiresPermissions(“role:update”)</p>
<p>public String editPower(@PathVariable(“id”) Integer id, Model model)</p>
<p>Role role = iRoleService.selectByPrimaryKey(id);</p>
<p>model.addAttribute(“Role”, role);</p>
<p>return prefix + “editPower”;</p>
<p>/**</p>
<ul>
<li><p>@描述 修改角色信息保存</p>
</li>
<li><p>@date 2018/9/16 16:12</p>
</li>
</ul>
<p>*/</p>
<p>@RequestMapping(“/editSave”)</p>
<p>@RequiresPermissions(“role:update”)</p>
<p>@Operlog(modal = “角色管理”,descr = “修改角色信息”)</p>
<p>@ResponseBody</p>
<p>public AjaxResult save(Role role)</p>
<p>int i = 0;</p>
<p>try</p>
<p>i = iRoleService.updateByPrimaryKeySelective(role);</p>
<p>catch (Exception e)</p>
<p>return error(e.getMessage());</p>
<p>return result(i);</p>
<p>/**</p>
<ul>
<li><p>@描述 修改角色权限信息保存</p>
</li>
<li><p>@date 2018/9/16 16:12</p>
</li>
</ul>
<p>*/</p>
<p>@RequestMapping(“/editPowerSave”)</p>
<p>@RequiresPermissions(“role:update”)</p>
<p>@Operlog(modal = “角色管理”,descr = “修改角色权限”)</p>
<p>@ResponseBody</p>
<p>public AjaxResult editPowerSave(Role role, Integer[] ids)</p>
<p>int i = 0;</p>
<p>try</p>
<p>if (StringUtils.isEmpty(ids))</p>
<p>ids = new Integer[0];</p>
<p>i = iRoleService.updateByPrimaryKeyPowerSelective(role, ids);</p>
<p>catch (Exception e)</p>
<p>return error(e.getMessage());</p>
<p>//清空缓存</p>
<p>ShiroUtils.clearCachedAuthorizationInfo();</p>
<p>//如果用户正在修改的角色id 是当前用户的角色id 则刷新 subject的User信息</p>
<p>if (role.getRoleId().equals(getRoleId()))</p>
<p>ShiroUtils.reloadUser(iUserService.selectByPrimaryKey(getUserId()));</p>
<p>return result(i);</p>
<p>/**</p>
<ul>
<li>校验名称唯一</li>
</ul>
<p>*/</p>
<p>@PostMapping(“/checkRoleNameUnique”)</p>
<p>@ResponseBody</p>
<p>public String checkDeptNameUnique(Role role)</p>
<p>String uniqueFlag = “0”;</p>
<p>if (role != null)</p>
<p>uniqueFlag = iRoleService.checkRoleNameUnique(role);</p>
<p>return uniqueFlag;</p>
<p>登录管理控制层：</p>
<p>@RequestMapping(“/oa”)</p>
<p>public class LoginController extends BaseController{</p>
<p>private static final Logger logger = LoggerFactory.getLogger(LoginController.class);</p>
<p>private String prefix = “system/user/“;</p>
<p>@Autowired</p>
<p>LoginService loginService;</p>
<p>@Autowired</p>
<p>IUserService userService;</p>
<p>/**</p>
<ul>
<li><p>@描述: 执行登录操作</p>
</li>
<li><p>@params: user:用户登录信息；</p>
</li>
<li><pre><code>     validateCode：验证码</code></pre>
</li>
<li><p>@return:</p>
</li>
<li><p>@date: 2018/9/29 21:20</p>
</li>
</ul>
<p>*/</p>
<p>@RequestMapping(“/login”)</p>
<p>@Operlog(descr = “用户登录”, modal = “登录模块”)</p>
<p>@ResponseBody</p>
<p>public AjaxResult Logining(User user, String validateCode, Boolean rememberMe, HttpServletRequest request)</p>
<p>HttpSession session = ServletUtils.getSession();</p>
<p>UsernamePasswordToken token = new UsernamePasswordToken(user.getName(), user.getPwd());</p>
<p>token.setRememberMe(rememberMe);</p>
<p>Subject subject = SecurityUtils.getSubject();</p>
<p>//验证用户名和密码 验证码的问题</p>
<p>try</p>
<p>loginService.checkLogin(user.getName(), user.getPwd(), validateCode);</p>
<p>catch (Exception e)</p>
<p>session.setAttribute(Constants.LOGIN_ERROR, e.getMessage());</p>
<p>return error(e.getMessage());</p>
<p>try</p>
<p>if (!subject.isAuthenticated())</p>
<p>subject.login(token);</p>
<p>catch (IncorrectCredentialsException e)</p>
<p>session.setAttribute(Constants.LOGIN_ERROR,”密码错误”);</p>
<p>return error(“密码错误！”);</p>
<p>catch (UnknownAccountException e)</p>
<p>session.setAttribute(Constants.LOGIN_ERROR,e.getMessage());</p>
<p>return error(e.getMessage());</p>
<p>catch (LockedAccountException e)</p>
<p>session.setAttribute(“login”,e.getMessage());</p>
<p>return error(e.getMessage());</p>
<p>catch (AuthenticationException e)</p>
<p>//            String msg = “用户名或密码错误！”;</p>
<p>//            if (!StringUtils.isEmpty(e.getMessage()))</p>
<p>//            {</p>
<p>//                msg = e.getMessage();</p>
<p>//            }</p>
<p>session.setAttribute(Constants.LOGIN_ERROR,e.getMessage());</p>
<p>return error(“系统异常！”);</p>
<p>return success();</p>
<p>/**</p>
<p>s sl</p>
<ul>
<li><p>@描述: 登录页面</p>
</li>
<li><p>@params:</p>
</li>
<li><p>@return:</p>
</li>
<li><p>@date: 2018/9/29 21:20</p>
</li>
</ul>
<p>*/</p>
<p>@RequestMapping(“/toLogin”)</p>
<p>public String toLogin()</p>
<p>return “login”;</p>
<p>开发者涨薪指南</p>
<p>48位大咖的思考法则、工作方式、逻辑体系</p>

      </div>
      
      
      
    </div>
    

    
    
    


          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt=""
      src="/images/avatar.png">
  <p class="site-author-name" itemprop="name"></p>
  <div class="site-description" itemprop="description">购买方式见各详情页<b>底部</b><br>所有项目均可<b><a href="/remote">免费远程</a></b>搭建调试运行</div>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        



        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>

<script src="/js/utils.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  
<div class="moon-menu">
  <div class="moon-menu-items">
    
    <div id="moon-menu-item-back2bottom" class="moon-menu-item">
      <i class='fas fa-chevron-down'></i>    </div>
    
    <div id="moon-menu-item-back2top" class="moon-menu-item">
      <i class='fas fa-chevron-up'></i>    </div>
    
  </div>
  <div class="moon-menu-button">
    <svg class="moon-menu-bg">
      <circle class="moon-menu-cricle" cx="50%" cy="50%" r="44%"></circle>
      <circle class="moon-menu-border" cx="50%" cy="50%" r="48%"></circle>
    </svg>
    <div class="moon-menu-content">
      <div class="moon-menu-icon"><i class='fas fa-ellipsis-v'></i></div>
      <div class="moon-menu-text"></div>
    </div>
  </div>
</div><script src="/js/injector.js"></script>
</body>
</html>
